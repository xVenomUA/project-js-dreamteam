{"version":3,"file":"commonHelpers.js","sources":["../src/js/korzina.js"],"sourcesContent":["import { getProductById } from \"./APIFoodBoutique\";\nimport iconimg from '/img/icon.svg';\n\n\n/* <!-- ₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴\n₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴\n    Ivan || Yulia \n₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴\n₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴ --> */\n// common\nconst common = {\n  FILTERS_KEY: 'filters',\n  CART_KEY: 'cart',\n};\nconst cardCounter = document.querySelector('span#cart-counter');\nconst cartJsBlock = document.querySelector('.js-cart-block');\nconst cartListBlock = document.querySelector('.cart-list-block');\nconst cartDeleteBtn = document.querySelector('.cart-delete-btn');\n\n\ncartDeleteBtn.addEventListener('click', onClick)\n\nfunction onClick() {\n  localStorage.removeItem('cart');\n  cardUse();\n  \n}\n\nfunction getDataLocalStorage(key) {\n  try {\n    const data = localStorage.getItem(key);\n    return data ? JSON.parse(data) : [];\n  } catch (error) {\n    console.log(error.message);\n  }\n}\nconst cartArr = getDataLocalStorage('cart');\nconst id = cartArr.map(item => item._id);\n\n\nasync function cardUse() {\n  let cartArr = await getDataLocalStorage(common.CART_KEY);\n  cardCounter.textContent = cartArr.length;\n\n  if (cartArr.length === 0) {\n    cartJsBlock.innerHTML = createMarkupCartEmpty();// createMarkup empty cart\n    return;\n  }\n  renderCards(cartArr);\n  // deleteAllBtn\n}\ncardUse();\n\nasync function renderCards() {\n  cartListBlock.innerHTML = '';\n\n  // let cartArr = await getDataLocalStorage(common.CART_KEY);\n  // for (const cartArrItem of cartArr) {\n  //   let id = cartArrItem.id;\n  \n  try {\n    for (let i = 0; i < id.length; i += 1) {\n      const resp = await getProductById(id[i]);\n      const cartId = renderProdCard(resp, id[i]);\n      cartListBlock.innerHTML += cartId;\n      \n      waitForElements('.cart-close')\n  .then(elements => {\n  \n    elements.forEach(element => {\n      element.addEventListener('click', e => {\n        console.log(e.currentTarget.id); \n        \n        \n        \n// console.log(element);\n     \n      });\n    });\n  })\n  .catch(error => {\n    console.error(error.message);\n  });\n      \n    }\n     \n      // const deleteBtn = document.querySelector(`.js-cart-block .`);\n      // const cartList = document.querySelector(\".js-cart-block .cart-list-block\");\n     \n    } catch (e) {\n      console.log(e);\n    }\n}\n  \n\n//    const cartClose = document.querySelector('.cart-close');\n// console.log(cartClose);\n      \n//   cartClose.addEventListener('click', onClose)\n// function onClose(event) {\n//     console.log(event.target);\n//   }\n\nfunction waitForElements(selector) {\n  return new Promise((resolve, reject) => {\n    const elements = document.querySelectorAll(selector);\n\n    if (elements.length > 0) {\n      resolve(elements);\n    } else {\n      const observer = new MutationObserver(() => {\n        const updatedElements = document.querySelectorAll(selector);\n        if (updatedElements.length > 0) {\n          observer.disconnect();\n          resolve(updatedElements);\n        }\n      });\n\n      observer.observe(document.documentElement, {\n        childList: true,\n        subtree: true,\n      });\n    }\n  });\n}\n\n\n\n\n\n// рендер доданої картки\n\nfunction renderProdCard(product) {\n  if (product.category.includes('_')) {\n    product.category = product.category.replace(/_/g, ' ');\n  }\n\n    return `\n        <div class=\"cart-card-container\" data-productlist-id=\"${product._id}\">\n          <div class=\"cart-image-container\">\n            <img src=\"${product.img}\" alt=\"${product.name}\" class=\"\">\n          </div>\n        \n        <div class=\"cart-info\">\n          <div class=\"cart-descript-text\">\n            <p class=\"cart-prod-name\">${product.name}</p>\n          <div class=\"cart-frame\">\n  \n          <div class=\"category-cont\">\n            <p class=\"cart-category-text\">Category:\n              <span class=\"cart-category-black\">${product.category}</span></p>\n              \n              <ul class=\"cart-text-cat\">\n              <li class=\"cart-text-size\">\n\n            <p class=\"cart-size-text\">Size:\n              <span class=\"cart-size-black\">${product.size}</span></p></li>\n              \n          </div>\n  \n            <div class=\"cart-price\">\n            <p class=\"cart-card-price\">${product.price}</p>\n          </div>\n            <hr class=\"cart-line\">\n\n           <button type=\"button\" id=\"${product._id}\" class=\"cart-close\">\n              <svg class=\"cart-close-icon\" width=\"18\" height=\"18\">\n                <use href=\"${iconimg}#icon-close\"></use>\n              </svg>\n            </button>\n\n          </div>\n        </div>\n      </div>\n    `;\n}\n\nfunction createMarkupCartEmpty() {\n  return ` \n  <div class=\"js-cart-block\">\n  <div class=\"cart-empty-basket\">\n  <img class=\"cart-basket-img\"\n                src=\"../img/yellowBasket.png\"\n                alt=\"yellow basket\"\n                loading=\"lazy\"\n                width=\"132\"\n                height=\"114\"\n              />\n  </div>\n  <div class=\"cart-empty-desc\">\n              <ul class=\"cart-desc-ul\">\n                <li>\n                  <p class=\"cart-empty-text\">\n                    Your basket is <span class=\"cart-text-span\">\n                    empty...</span>\n                  </p>\n                </li>\n                <li>\n                  <p class=\"cart-gray-text\">\n                    Go to the main page to select your favorite <br /> products and add\n                    them to the cart.\n                  </p>\n                </li>\n              </ul>\n            </div>\n  `;\n}\n\n\n\n{/* // TO BE continued...\n\n //  localStorage\nfunction saveData(data, key) {\n//     localStorage.setItem(key, JSON.stringify(data))\n// }\n\n//  function getData(key) {\n//     const data = localStorage.getItem(key);\n\n//     return data ? JSON.parse(data) : []\n// }\n\n// // addProducts\n\n// export function addProducts() {\n//     const cartArr = getData(common.CART_KEY);\n\n//     cartArr.forEach(_id => {\n//         const products = document.querySelectorAll(`[data-idcards=\"${_id}]`);\n\n//         products.forEach(product => {\n//             const productBtn = // знайти кнопку, яка додає товар\n//                 productBtn.innerHTML = `<svg class=\"_item-checked\"><use href=\"\"></></svg>`;\n//         }\n//             )\n//     })\n// }\n\n// export function removeProducts() {\n//     const cartArr = getData(common.CART_KEY);\n\n//     cartArr.forEach(_id => {\n//         const products = document.querySelectorAll(`[data-idcards=\"${_id}]`);\n\n//     }\n//     )\n// } */}\n"],"names":["common","cardCounter","cartJsBlock","cartListBlock","cartDeleteBtn","onClick","cardUse","getDataLocalStorage","key","data","error","cartArr","id","item","createMarkupCartEmpty","renderCards","i","resp","getProductById","cartId","renderProdCard","waitForElements","elements","element","e","selector","resolve","reject","observer","updatedElements","product","iconimg"],"mappings":"yFAUA,MAAMA,EAAS,CACb,YAAa,UACb,SAAU,MACZ,EACMC,EAAc,SAAS,cAAc,mBAAmB,EACxDC,EAAc,SAAS,cAAc,gBAAgB,EACrDC,EAAgB,SAAS,cAAc,kBAAkB,EACzDC,EAAgB,SAAS,cAAc,kBAAkB,EAG/DA,EAAc,iBAAiB,QAASC,CAAO,EAE/C,SAASA,GAAU,CACjB,aAAa,WAAW,MAAM,EAC9BC,GAEF,CAEA,SAASC,EAAoBC,EAAK,CAChC,GAAI,CACF,MAAMC,EAAO,aAAa,QAAQD,CAAG,EACrC,OAAOC,EAAO,KAAK,MAAMA,CAAI,EAAI,CAAA,CAClC,OAAQC,EAAP,CACA,QAAQ,IAAIA,EAAM,OAAO,CAC1B,CACH,CACA,MAAMC,EAAUJ,EAAoB,MAAM,EACpCK,EAAKD,EAAQ,IAAIE,GAAQA,EAAK,GAAG,EAGvC,eAAeP,GAAU,CACvB,IAAIK,EAAU,MAAMJ,EAAoBP,EAAO,QAAQ,EAGvD,GAFAC,EAAY,YAAcU,EAAQ,OAE9BA,EAAQ,SAAW,EAAG,CACxBT,EAAY,UAAYY,IACxB,MACD,CACDC,EAAmB,CAErB,CACAT,IAEA,eAAeS,GAAc,CAC3BZ,EAAc,UAAY,GAM1B,GAAI,CACF,QAASa,EAAI,EAAGA,EAAIJ,EAAG,OAAQI,GAAK,EAAG,CACrC,MAAMC,EAAO,MAAMC,EAAeN,EAAGI,EAAE,EACjCG,EAASC,EAAeH,EAAML,EAAGI,EAAE,EACzCb,EAAc,WAAagB,EAE3BE,EAAgB,aAAa,EAChC,KAAKC,GAAY,CAEhBA,EAAS,QAAQC,GAAW,CAC1BA,EAAQ,iBAAiB,QAASC,GAAK,CACrC,QAAQ,IAAIA,EAAE,cAAc,EAAE,CAMtC,CAAO,CACP,CAAK,CACL,CAAG,EACA,MAAMd,GAAS,CACd,QAAQ,MAAMA,EAAM,OAAO,CAC/B,CAAG,CAEE,CAKA,OAAQc,EAAP,CACA,QAAQ,IAAIA,CAAC,CACd,CACL,CAWA,SAASH,EAAgBI,EAAU,CACjC,OAAO,IAAI,QAAQ,CAACC,EAASC,IAAW,CACtC,MAAML,EAAW,SAAS,iBAAiBG,CAAQ,EAEnD,GAAIH,EAAS,OAAS,EACpBI,EAAQJ,CAAQ,MACX,CACL,MAAMM,EAAW,IAAI,iBAAiB,IAAM,CAC1C,MAAMC,EAAkB,SAAS,iBAAiBJ,CAAQ,EACtDI,EAAgB,OAAS,IAC3BD,EAAS,WAAU,EACnBF,EAAQG,CAAe,EAEjC,CAAO,EAEDD,EAAS,QAAQ,SAAS,gBAAiB,CACzC,UAAW,GACX,QAAS,EACjB,CAAO,CACF,CACL,CAAG,CACH,CAQA,SAASR,EAAeU,EAAS,CAC/B,OAAIA,EAAQ,SAAS,SAAS,GAAG,IAC/BA,EAAQ,SAAWA,EAAQ,SAAS,QAAQ,KAAM,GAAG,GAG9C;AAAA,gEACqDA,EAAQ;AAAA;AAAA,wBAEhDA,EAAQ,aAAaA,EAAQ;AAAA;AAAA;AAAA;AAAA;AAAA,wCAKbA,EAAQ;AAAA;AAAA;AAAA;AAAA;AAAA,kDAKEA,EAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8CAMZA,EAAQ;AAAA;AAAA;AAAA;AAAA;AAAA,yCAKbA,EAAQ;AAAA;AAAA;AAAA;AAAA,uCAIVA,EAAQ;AAAA;AAAA,6BAElBC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAQ7B,CAEA,SAASjB,GAAwB,CAC/B,MAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GA4BT"}