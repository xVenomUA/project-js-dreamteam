{"version":3,"file":"commonHelpers.js","sources":["../src/img/yellowBasket.png","../src/js/korzina.js"],"sourcesContent":["export default \"__VITE_ASSET__331ff7d5__\"","import { getProductById } from './APIFoodBoutique';\nimport iconimg from '/img/icon.svg';\nimport basket from '/img/yellowBasket.png';\n/* <!-- ₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴\n₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴\n    Ivan || Yulia || Valentyn\n₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴\n₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴₴ --> */\n// common\nconst common = {\n  FILTERS_KEY: 'filters',\n  CART_KEY: 'cart',\n};\nconst cardCounter = document.querySelector('span#cart-counter');\nconst cartJsBlock = document.querySelector('.js-cart-block');\nconst cartListBlock = document.querySelector('.cart-list-block');\nconst cartDeleteBtn = document.querySelector('.cart-delete-btn');\n\ncartDeleteBtn.addEventListener('click', onClick);\n\nfunction onClick() {\n  localStorage.removeItem('cart');\n  cardUse();\n}\n\nfunction getDataLocalStorage(key) {\n  try {\n    const data = localStorage.getItem(key);\n    return data ? JSON.parse(data) : [];\n  } catch (error) {\n    console.log(error.message);\n  }\n}\n\nasync function cardUse() {\n  let cartArr = await getDataLocalStorage(common.CART_KEY);\n\n  cardCounter.textContent = cartArr.length;\n\n  if (cartArr.length === 0) {\n    cartJsBlock.innerHTML = createMarkupCartEmpty(); // createMarkup empty cart\n    return;\n  }\n  renderCards(cartArr);\n  // deleteAllBtn\n}\ncardUse();\n\nasync function renderCards() {\n  const cartArr = getDataLocalStorage('cart');\n  const id = cartArr.map(item => item._id);\n  cartListBlock.innerHTML = '';\n\n  try {\n    let total = 0;\n    let prices = [];\n    let cartList = [];\n    let listArr = []; // елементи в корзині\n    for (let i = 0; i < id.length; i += 1) {\n      const resp = await getProductById(id[i]);\n      const cartId = renderProdCard(resp, id[i]);\n      cartListBlock.innerHTML += cartId;\n\n      const cartParce = JSON.parse(localStorage.getItem('cart'));\n      total += resp.price;\n      prices.push(resp.price);\n      console.log(total);\n      spanYourOrderPrice.textContent = `${Number(total.toFixed(2))}`;\n\n      waitForElements('.cart-close')\n        .then(elements => {\n          listArr.push(cartParce[i]._id);\n\n          localStorage.setItem('cart1', JSON.stringify(cartList));\n          elements.forEach(element => {\n            element.addEventListener('click', e => {\n              const id = e.currentTarget.id;\n\n              listArr = listArr.filter(item => item !== id);\n\n              cartList = [];\n              for (let j = 0; j < listArr.length; j += 1) {\n                cartList.push({ _id: listArr[j], quantity: 1 });\n              }\n\n              localStorage.setItem('cart', JSON.stringify(cartList));\n              cardUse();\n            });\n          });\n        })\n\n        .catch(error => {\n          console.error(error.message);\n        });\n    }\n  } catch (e) {\n    console.log(e);\n  }\n}\n\nfunction waitForElements(selector) {\n  return new Promise((resolve, reject) => {\n    const elements = document.querySelectorAll(selector);\n\n    if (elements.length > 0) {\n      resolve(elements);\n    } else {\n      const observer = new MutationObserver(() => {\n        const updatedElements = document.querySelectorAll(selector);\n        if (updatedElements.length > 0) {\n          observer.disconnect();\n          resolve(updatedElements);\n        }\n      });\n\n      observer.observe(document.documentElement, {\n        childList: true,\n        subtree: true,\n      });\n    }\n  });\n}\n\n// рендер доданої картки\n\nfunction renderProdCard(product) {\n  if (product.category.includes('_')) {\n    product.category = product.category.replace(/_/g, ' ');\n  }\n\n  return `\n        <div class=\"cart-card-container\" data-productlist-id=\"${product._id}\">\n          <div class=\"cart-image-container\">\n            <img src=\"${product.img}\" alt=\"${product.name}\" class=\"\">\n          </div>\n        \n        <div class=\"cart-info\">\n          <div class=\"cart-descript-text\">\n            <p class=\"cart-prod-name\">${product.name}</p>\n          <div class=\"cart-frame\">\n  \n          <div class=\"category-cont\">\n            <p class=\"cart-category-text\">Category:\n              <span class=\"cart-category-black\">${product.category}</span></p>\n              \n              <ul class=\"cart-text-cat\">\n              <li class=\"cart-text-size\">\n\n            <p class=\"cart-size-text\">Size:\n              <span class=\"cart-size-black\">${product.size}</span></p></li>\n              \n          </div>\n  \n            <div class=\"cart-price\">\n            <p class=\"cart-card-price\">${product.price}</p>\n          </div>\n            <hr class=\"cart-line\">\n\n           <button type=\"button\" id=\"${product._id}\" class=\"cart-close\">\n              <svg class=\"cart-close-icon\" width=\"18\" height=\"18\">\n                <use href=\"${iconimg}#icon-close\"></use>\n              </svg>\n            </button>\n\n          </div>\n        </div>\n      </div>\n    `;\n}\n\nfunction createMarkupCartEmpty() {\n  return ` \n  <div class=\"js-cart-block\">\n  <div class=\"cart-empty-basket\">\n  <img class=\"cart-basket-img\"\n                src=\"${basket}\"\n                alt=\"yellow basket\"\n                loading=\"lazy\"\n                width=\"132\"\n                height=\"114\"\n              />\n  </div>\n  <div class=\"cart-empty-desc\">\n              <ul class=\"cart-desc-ul\">\n                <li>\n                  <p class=\"cart-empty-text\">\n                    Your basket is <span class=\"cart-text-span\">\n                    empty...</span>\n                  </p>\n                </li>\n                <li>\n                  <p class=\"cart-gray-text\">\n                    Go to the main page to select your favorite <br /> products and add\n                    them to the cart.\n                  </p>\n                </li>\n              </ul>\n            </div>\n  `;\n}\nconst spanYourOrderPrice = document.querySelector(\n  'span#your-order-total-price'\n);\n"],"names":["basket","common","cardCounter","cartJsBlock","cartListBlock","cartDeleteBtn","onClick","cardUse","getDataLocalStorage","key","data","error","cartArr","createMarkupCartEmpty","renderCards","id","item","total","prices","cartList","listArr","i","resp","getProductById","cartId","renderProdCard","cartParce","spanYourOrderPrice","waitForElements","elements","element","e","j","selector","resolve","reject","observer","updatedElements","product","iconimg"],"mappings":"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"}